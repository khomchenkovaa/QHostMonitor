  <tr>
    <td><p align=justify><br>
     Starting from HostMonitor version 3.40 you can create your own tests using different script languages such as Visual
      Basic Script or Java Script. HostMonitor uses Microsoft ActiveScripting technology to execute scripts that were
      written by you or somebody else. Theoretically using this type of test you can check anything what is possible to
      check (if its impossible to retrieve some information using script language, you can create ActiveX object (e.g.
      using C++) and use this object in the script). So, you are the one who can improve HostMonitor to suit all your
      needs. BTW you can create your own script language<br>
     In addition to the <a href="#Dialog">common test parameters</a>, the Script test has the following options:<br><br>

     <b>Run script from external file</b><br>
     Set this option and specify script file name that HostMonitor will load and execute every time test is performed.
      This option allows you to change script any time without changing HostMonitor's settings. E.g. HostMonitor can be
      loaded on server machine and execute scripts located on workstations.<br><br>

     <b>Store script inside HML file</b><br>
     With this option enabled HostMonitor will store script inside HML file with test settings. You can protect
      HostMonitor's settings by password and be sure nobody read or modify your scripts.<br><br>

     <b>Language</b><br>
     The Language property determines language in which a script is written. HostMonitor can use any script engine that
      is installed on your system. VBScript and JScript installed by default on Windows 2000/XP. Also you can download
      and install additional script languages, for more information please refer to <a href="#scriptTechReq">Technical
      requirements</a> paragraph.<br><br>

     <b>Timeout</b><br>
     The Timeout property offers a safety shield to prevent a script program from going into an infinite loop and
      locking up the system.  It specifies the maximum number of seconds the script will run before an error will be
      generated.<br><br>

     <b>Alow UI</b><br>
     When this option enabled the script program can display user interface (UI) elements such as a MsgBox.<br><br>

     <b>Translate macros</b><br>
     With this option enabled you can use special <a href="actions.htm#macro">macro variables</a> in your
      script.<br><br>

     Also Test Properties dialog contains Edit and Test buttons. First button opens Script Editor window that allows
      you to view, modify, and execute script. Test button executes script and displays result or an error message.<br><br>

     <br>
     <b>Requirements to the script:</b><br>
     HostMonitor has just a few requirements:
     <table width="100%" border=0>
      <tr><td valign=top nowrap> 1. </td><td> script must contain "performtest" function. HM always call function with this name</td></tr>
      <tr><td valign=top nowrap> 2. </td><td> "performtest" function must not have any parameters</td></tr>
      <tr><td valign=top nowrap> 3. </td><td> "performtest" function must return string value. This string contains two parts separated by colon (:).
        First obligatory part contains test status, it can take following values:<br>
       <ul class=list00>
        <li> "Host is alive"
        <li> "No answer"
        <li> "Unknown"
        <li> "Unknown host"
        <li> "Ok"
        <li> "Bad"
        <li> "Bad contents"
       </ul>
        Second optional part contains "Reply" value, HostMonitor displays this value in Reply field, writes to log
         files, uses to displays charts (Log Analyzer), etc.<br>
        Several examples:<br>
        <table border=0>
         <tr><td nowrap><font color="#0000D5">return "Host is alive:1000 ms"</font> </td><td nowrap>| Jscript;	Status: Host is alive;  Reply: 1000 ms </td></tr>
         <tr><td nowrap><font color="#0000D5">return "Unknown host:"</font>     	  </td><td nowrap>| Jscript;	Status: Unknown host;	Reply: empty   </td></tr>
         <tr><td nowrap><font color="#0000D5">performtest = "Ok:300 Kb"</font>      </td><td nowrap>| VBscript;	Status: Ok;		Reply: 300 Kb  </td></tr>
         <tr><td nowrap><font color="#0000D5">performtest = "Bad:90 %" </font> 	  </td><td nowrap>| VBscript;	Status: Bad;		Reply: 90 %    </td></tr>
        </table>
     </td></tr>
     <tr><td valign=top nowrap> 3a. </td><td> If you want Log Analyzer will be able correctly process "Reply" values and displays charts, use
        one of the following formats for "Reply" value:
       <ul class=list00>
        <li> decimal_number (like '123', '0', '6456.45'. as decimal separator use symbol that is specified on your system, usually a dot (.) or a comma (,))
        <li> decimal_number + space + 'Kb' (like '512 Kb', '64 Kb') <br>
        <li> decimal_number + space + 'Mb' (like '1024 Mb', '5 Mb') <br>
        <li> decimal_number + space + 'Gb' (like '12 Gb', '4 Gb')   <br>
        <li> decimal_number + space + '%' (like '50 %', '99 %')     <br>
        <li> decimal_number + space + 'ms' (like '100 ms', '5400 ms')
       </ul>
      </td></tr>
     </table>
     That's it. Everything else is entirely up to you<br><br>

     <p align=justify>
     When you create new script HostMonitor provides template with constants that describe test statuses and with empty
      "performtest" function.<br>
     Also you can find several simple examples of scripts in HostMonitor's directory "Examples\".<br>
     <table width="100%" border=0>
      <tr><td nowrap valign=top>DrivesList.vbs </td><td nowrap valign=top> - </td><td>VBScript, checks list of disk drives on local system. Set test's status to "Bad" when list of drives changes. E.g. when user map/unmap network drive.</td></tr>
      <tr><td nowrap valign=top>DrivesList.js  </td><td nowrap valign=top> - </td><td>JScript, analogue of DrivesList.vbs</td></tr>
      <tr><td nowrap valign=top>DiskSpaces.vbs </td><td nowrap valign=top> - </td><td>VBScript, checks difference between free disk space on drive C: and drive D: Sets status to "Bad" when drive C: has less amount of free space than drive D:</td></tr>
      <tr><td nowrap valign=top>DiskSpaces.js  </td><td nowrap valign=top> - </td><td>JScript, analogue DiskSpaces.vbs</td></tr>
      <tr><td nowrap valign=top>CheckWord.vbs  </td><td nowrap valign=top> - </td><td>VBScript, statrs MS Word, opens document and returns number of characters in the document. If MS Word is not installed or document does not exist, test's status will be "Uknown"</td></tr>
      <tr><td nowrap valign=top>RegRead.vbs    </td><td nowrap valign=top> - </td><td>VBScript, reads registry data. Sets test's status to "Bad" when some application (or a user) changes address to a web page that Internet Explorer use as home page</td></tr>
      <tr><td nowrap valign=top>RegRead.js     </td><td nowrap valign=top> - </td><td>JScript, analogue RegRead.vbs</td></tr>
     </table><br>

     <br>
     <b><a name="scriptTechReq">Technical requirements:</a></b><br>
     As we already said HostMonitor uses Microsoft ActiveScripting technology to execute scripts. Microsoft ActiveScript
      is basically 2 related COM objects: the scripting engine and the scripting host.<br>
     The scripting host is responsible for the interaction between application and the scripting engine. HostMonitor
      uses MS Script Control as scripting host. It means MS Script Control must be installed on your system to perform
      script tests. Normally, this control is installed in Windows 2000, and Windows XP. If you have an old versions of
      Windows (Windows 98/ME/NT 4.0), you can download the MS Script Control from
      <a href="http://msdn.microsoft.com/downloads/default.asp?URL=/downloads/sample.asp?url=/msdn-files/027/001/733/msdncompositedoc.xml" target="_blank">
               http://msdn.microsoft.com/downloads/default.asp?URL=/downloads/sample.asp?url=/msdn-files/027/001/733/msdncompositedoc.xml</a><br><br>

     The scripting engine is the COM object that actually processes the scripts, e.g. VBScript, JScript, etc. These COM
      objects are usually provided by a third party (in the case of VBScript it's provided by Microsoft). On Windows
      2000/XP VBScript and Jscript installed by default, also you can download and install additional script languages.
      If you have old version of Windows or if you want to use another script language, follow links can be useful for
      you:
     <ul class=list00>
      <li> Visual Basic Script (VBScript) and Java Script (Jscript) for Windows 98, ME, NT 4.0, 2000 are available at <a href="http://msdn.microsoft.com/scripting" target="_blank">http://msdn.microsoft.com/scripting</a><br>
      <li> Perl is available from <a href="http://www.activestate.com" target="_blank">www.activestate.com</a><br>
      <li> Python is available at the same site <a href="http://www.activestate.com" target="_blank">www.activestate.com</a><br>
      <li> Haskell is available at <a href="http://www.haskell.org/haskellwiki/Haskell" target="_blank">http://www.haskell.org/haskellwiki/Haskell</a>
     </ul>
     Of course we don't know about all script languages available on the Internet, these are just the most popular that
     we know about.<br><br>

     <br>
     <b>Useful links:</b><br>
     There are some useful links:<br>
     Scripting FAQ: <a href="http://www.mindspring.com/~mark_baker/toc.htm" target="_blank">http://www.mindspring.com/~mark_baker/toc.htm</a><br>
     Microsoft Visual Basic Script documentation available at <a href="http://www.microsoft.com/en-us/download/details.aspx?id=2764" target="_blank">http://www.microsoft.com/en-us/download/details.aspx?id=2764</a><br>
     Microsoft Java Script documentation available at <a href="http://msdn.microsoft.com/en-us/library/hbxc2t98(VS.85).aspx" target="_blank">http://msdn.microsoft.com/en-us/library/hbxc2t98(VS.85).aspx</a><br><br>
     <!-- also http://msdn.microsoft.com/en-us/library/hbxc2t98(VS.85).aspx -->
  </td></tr>
